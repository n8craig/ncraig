{"title":"ICE Detention COVID-19 Maps","markdown":{"yaml":{"title":"ICE Detention COVID-19 Maps","description":"Animated visualizations of COVID-19 infections in ICE detention over time.\n","author":[{"name":"Nathan Craig","url":"https://ncraig.netlify.app/"}],"date":"05-23-2021","categories":["immigration"],"output":{"distill::distill_article":{"self_contained":false,"df_print":"paged","toc":true,"number_sections":false}},"format":{"html":{"toc":true}},"image":"COVID-19-map.jpg","from":"markdown+tex_math_single_backslash","bibliography":"packages.bib","link-citations":"yes","repository_url":"https://github.com/n8craig/ncraig","creative_commons":"CC BY-NC"},"headingText":"Data loading","containsRefs":false,"markdown":"\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = FALSE,\n                      message = FALSE,\n                      warning = FALSE)\n```\n\n```{r}\nlibrary(readr)\n\n# Data wrangling\nlibrary(tidyverse)\nlibrary(janitor)\n\n# Spatial data\nlibrary(sf)\nlibrary(maps)\n\n# Plotting\nlibrary(ggplot2)\nlibrary(gganimate)\nlibrary(magick)\nlibrary(patchwork)\n```\n\n```{r}\n# Load facility specific data\ndf <- read_csv(\"https://raw.githubusercontent.com/n8craig/ICE-COVID-19/main/data/covid_by_facility.csv\", \n    col_types = cols(Date = col_date(format = \"%Y-%m-%d\"), \n        `Confirmed cases currently under isolation or monitoring` = col_number(), \n        `Detainee deaths` = col_number(), \n        `Total confirmed COVID-19 cases` = col_number()))\ndf <- clean_names(df)\n\nlocations <- read_csv(\"https://raw.githubusercontent.com/n8craig/ICE-COVID-19/main/data/facility_management_location.csv\")\nlocations <- clean_names(locations)\n\ndf <- left_join(df, locations)\ndf <- df %>% mutate(manager = as.factor(manager))\n\n\n# Load summary data\ndf_summary <- read_csv(\"https://raw.githubusercontent.com/n8craig/ICE-COVID-19/main/data/covid_summaries.csv\",\n                       col_types = cols(Date = col_date(format = \"%Y-%m-%d\")))\ndf_summary <- clean_names(df_summary)\ndf_summary$date <- as.Date(df_summary$date)\n```\n\n# COVID-19 Cases in ICE Detention Over Time\n\nThe following maps and graph are generated with data scraped from the [ICE Guidance on COVID-19](https://www.ice.gov/coronavirus) website. The scraped data are maintained in a GitHub [repository](https://github.com/n8craig/ICE-COVID-19). COVID-19 data reported by ICE are linked with geocoded facility locations. COVID-19 data are assembled in \"long\" format, plotted with `ggplot` [@R-ggplot2], and animated with the `gganimate` [@R-gganimate] library.\n\n## Cumulative COVID-19 Map\n\nA map of cumulative COVID-19 cases by ICE detention facility over time.\n\n```{r, eval=FALSE}\n#| column: margin\n\ndf <- df %>% \n  filter(type !=\"Hotel\")\n\nfig <- \n  df %>% \n  drop_na(type) %>% # Long term should resolve these records that don't match.!\n  ggplot(aes(x=longitude, y=latitude))+\n  borders(\"state\")+\n  geom_point(alpha = 0.2,\n             aes(color = type,\n                 size = total_confirmed_covid_19_cases,\n                 frame = date,\n                 group = 1L\n                 ))+\n  guides(color = guide_legend(override.aes = list(alpha= 1)))+\n  coord_sf(xlim = c(-124,-68), ylim = c(24, 49.5), expand = TRUE)+\n  theme(legend.position = \"right\")+\n  labs(\n    title = \"Cumulative COVID-19 Cases\",\n    caption = \"Data source: https://www.ice.gov/coronavirus\"\n    )+\n  guides(size = FALSE, alpha = FALSE)\nfig\n```\n\n```{r}\n\ndf <- df %>% \n  filter(type !=\"Hotel\")\n\nfig <- \n  df %>% \n  drop_na(type) %>% # Long term should resolve these records that don't match.!\n  ggplot(aes(x=longitude, y=latitude))+\n  borders(\"state\")+\n  geom_point(alpha = 0.2,\n             aes(color = type,\n                 size = total_confirmed_covid_19_cases,\n                 frame = date,\n                 group = 1L\n                 ))+\n  guides(color = guide_legend(override.aes = list(alpha= 1)))+\n  coord_sf(xlim = c(-124,-68), ylim = c(24, 49.5), expand = TRUE)+\n  transition_time(date)+\n  ease_aes()+\n  theme(legend.position = \"right\")+\n  labs(\n    title = \"Cumulative COVID-19 Cases: {frame_time}\",\n    caption = \"Data source: https://www.ice.gov/coronavirus\"\n    )+\n  guides(size = FALSE, alpha = FALSE)\n\nanimate(fig, fps=4, end_pause = 7)\n```\n\n## Cumulative COVID-19 Line Plot\n\n```{r}\nfig <- \ndf_summary %>% \n  ggplot(aes(x=date, y=total_cumulative_covid_19))+\n  geom_line()+\n  geom_point()+\n  transition_time(date)+\n  transition_reveal(date)+\n  labs(\n    title = \"Cumulative COVID-19 Cases: {frame_along}\",\n    caption = \"Data source: https://www.ice.gov/coronavirus\"\n  )+\n  xlab(\"Date\")+\n  ylab(\"Cumulative COVID-19 Cases in ICE Detention\")\n\nanimate(fig, fps=4, end_pause = 7)\n```\n\n## Total Detained and Active Cases Line Plot Over Time\n\nThe following is a pair of line plots showing detained population and active COVID-19 cases in custody over time. Comparing the plots one can see that between July and January 2020 as the detained population decreased the number of active COVID-19 cases in custody declined. Likewise, one can see that in late March 2021 as the total detained population began to rise the number of active COVID-19 cases in custody also rose and that by April 2021 both the detained population and active COVID-19 cases in ICE detention are rising rapidly.\n\n```{r}\n# ICE Detention Population Over Time\ntotal_detained <- ggplot(df_summary, aes(x=date, y=total_detained))+\n  geom_line()+\n  geom_point()+\n  geom_smooth()+\n  labs(\n    title = \"ICE Detention Population \\nOver Time\",\n    subtitle = \"Smoothed trend line added\"\n  )+\n  xlab(\"Date\")+\n  ylab(\"Total Detained Population\")\n\n\n# Total Confirmed COVID-19 Over Time\nactive_in_custody <- ggplot(df_summary, aes(x=date, y=total_covid_19_confirmed_in_custody))+\n  geom_line()+\n  geom_smooth()+\n   labs(\n    title = \"Confirmed COVID-19 Cases \\nin ICE Detention Over Time\",\n    subtitle = \"Smoothed trend line added\",\n    caption = \"Data source: https://www.ice.gov/coronavirus\"\n  )+\n  xlab(\"Date\")+\n  ylab(\"Total Active COVID-19 Cases in Custody\")\n\ntotal_detained + active_in_custody\n```\n\n## Active COVID-19 Map\n\nA map of active COVID-19 cases by ICE detention facility over time.\n\n```{r}\ndf <- df %>% \n  filter(type !=\"Hotel\")\n\nfig <- \n  df %>% \n  drop_na(type) %>% # Long term should resolve these records that don't match.!\n  ggplot(aes(x=longitude, y=latitude))+\n  borders(\"state\")+\n  geom_point(alpha = 0.2,\n             aes(color = type,\n                 size = confirmed_cases_currently_under_isolation_or_monitoring,\n                 frame = date,\n                 group = 1L\n                 ))+\n  guides(color = guide_legend(override.aes = list(alpha= 1)))+\n  coord_sf(xlim = c(-124,-68), ylim = c(24, 49.5), expand = TRUE)+\n  transition_time(date)+\n  ease_aes()+\n  theme(legend.position = \"right\")+\n  labs(\n    title = \"Active COVID-19 Cases: {frame_time}\",\n    caption = \"Data source: https://www.ice.gov/coronavirus\"\n    )+\n  guides(size = FALSE, alpha = FALSE)\n\nanimate(fig, fps=4, end_pause = 7)\n```\n\n```{r}\nknitr::write_bib(file = \"packages.bib\")\n```\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":"auto","echo":true,"output":{"distill::distill_article":{"self_contained":false,"df_print":"paged","toc":true,"number_sections":false}},"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"toc":true,"from":"markdown+tex_math_single_backslash","output-file":"index.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.269","editor":"visual","theme":"lux","mainfont":"Sorts Mill Goudy","title":"ICE Detention COVID-19 Maps","description":"Animated visualizations of COVID-19 infections in ICE detention over time.\n","author":[{"name":"Nathan Craig","url":"https://ncraig.netlify.app/"}],"date":"05-23-2021","categories":["immigration"],"image":"COVID-19-map.jpg","bibliography":["packages.bib"],"link-citations":"yes","repository_url":"https://github.com/n8craig/ncraig","creative_commons":"CC BY-NC"},"extensions":{"book":{"multiFile":true}}}}}